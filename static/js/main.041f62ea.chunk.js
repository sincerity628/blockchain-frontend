(this["webpackJsonpchianblock-basis"]=this["webpackJsonpchianblock-basis"]||[]).push([[0],{15:function(e,t,a){"use strict";a.r(t),a.d(t,"initChain",(function(){return c})),a.d(t,"addTransaction",(function(){return i}));var n=(0,a(29).ec)("secp256k1"),l=a(36).Transaction,c=new(0,a(77).Blockchain),r=n.keyFromPrivate("079428c87bbf98b5dadf1ad971f721c8ea5a6aef865f1ece3f6ccece081d31cc"),i=function(e){var t=new l(e.from,e.to,e.amount);t.signTransaction(r),c.addTransaction(t)}},36:function(e,t,a){"use strict";a.r(t),function(e){var t=a(18),n=a(19),l=a(38),c=(0,a(29).ec)("secp256k1"),r=function(){function e(a,n,l){Object(t.a)(this,e),this.from=a,this.to=n,this.amount=l,this.timestamp=Date.now()}return Object(n.a)(e,[{key:"calculateHash",value:function(){return l(this.from+this.to+this.amount).toString()}},{key:"signTransaction",value:function(e){if(e.getPublic("hex")===this.from){var t=this.calculateHash(),a=e.sign(t,"base64");this.signature=a.toDER("hex")}else console.log("can not sign to this transaction.")}},{key:"isValid",value:function(){return null===this.from||(this.signature&&0!==this.signature.length?c.keyFromPublic(this.from,"hex").verify(this.calculateHash(),this.signature):void console.log("no signature in this transaction."))}}]),e}();e.exports.Transaction=r}.call(this,a(37)(e))},42:function(e,t,a){e.exports=a(82)},47:function(e,t,a){},48:function(e,t,a){},54:function(e,t,a){},57:function(e,t){},58:function(e,t){},77:function(e,t,a){"use strict";a.r(t),function(e){var t=a(18),n=a(19),l=a(38),c=a(36).Transaction,r=function(){function e(a,n){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(t.a)(this,e),this.prevHash=l,this.timestamp=a,this.transaction=n,this.random=0,this.hash=this.calculateHash()}return Object(n.a)(e,[{key:"calculateHash",value:function(){return l(this.prevHash+this.timestamp+JSON.stringify(this.transaction)+this.random).toString()}},{key:"mine",value:function(e){for(;this.hash.substring(0,e)!==Array(e+1).join(0);)this.random++,this.hash=this.calculateHash()}},{key:"hasValidTransaction",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,l=this.transaction[Symbol.iterator]();!(e=(n=l.next()).done);e=!0){if(!n.value.isValid)return!1}}catch(c){t=!0,a=c}finally{try{e||null==l.return||l.return()}finally{if(t)throw a}}return!0}}]),e}(),i=function(){function e(){Object(t.a)(this,e),this.chain=[this.createNewBlock()],this.difficulty=3,this.miningAward=100,this.transactionQueue=[]}return Object(n.a)(e,[{key:"createNewBlock",value:function(){return new r("1576067366730",[],"0")}},{key:"getLatestBlock",value:function(){return this.chain[this.chain.length-1]}},{key:"mineTheTransactionQueue",value:function(e){var t=new c(null,e,this.miningAward);this.transactionQueue.push(t);var a=new r(Date.now(),this.transactionQueue);a.prevHash=this.getLatestBlock().hash,a.hash=a.calculateHash(),a.mine(this.difficulty),this.chain.push(a),this.transactionQueue=[]}},{key:"addTransaction",value:function(e){e.from&&e.to?e.isValid()?this.transactionQueue.push(e):console.log("can not add invalid into the chain."):console.log("transaction must have from & to.")}},{key:"getBalence",value:function(e){var t=0,a=!0,n=!1,l=void 0;try{for(var c,r=this.chain[Symbol.iterator]();!(a=(c=r.next()).done);a=!0){var i=c.value,s=!0,o=!1,m=void 0;try{for(var u,h=i.transaction[Symbol.iterator]();!(s=(u=h.next()).done);s=!0){var d=u.value;e===d.from&&(t-=d.amount),e===d.to&&(t+=d.amount)}}catch(f){o=!0,m=f}finally{try{s||null==h.return||h.return()}finally{if(o)throw m}}}}catch(f){n=!0,l=f}finally{try{a||null==r.return||r.return()}finally{if(n)throw l}}return t}},{key:"getTrans",value:function(e){var t=[],a=!0,n=!1,l=void 0;try{for(var c,r=this.chain[Symbol.iterator]();!(a=(c=r.next()).done);a=!0){var i=c.value,s=!0,o=!1,m=void 0;try{for(var u,h=i.transaction[Symbol.iterator]();!(s=(u=h.next()).done);s=!0){var d=u.value;d.from!==e&&d.to!==e||t.push(d)}}catch(f){o=!0,m=f}finally{try{s||null==h.return||h.return()}finally{if(o)throw m}}}}catch(f){n=!0,l=f}finally{try{a||null==r.return||r.return()}finally{if(n)throw l}}return t}},{key:"isChainValid",value:function(){for(var e=0;e<this.chain.length;e++){var t=this.chain[e],a=this.chain[e-1];if(!t.hasValidTransaction())return console.log("warning! the block ("+e+") has no valid transaction."),!1;if(t.calculateHash()!==t.hash)return console.log("warning! the block("+e+") has been changed."),!1;if(e>0&&t.prevHash!==a.hash)return console.log("warning! the block("+e+") is not connected with the block("+(e-1)+")."),!1;var n=JSON.stringify(this.createNewBlock());if(JSON.stringify(this.chain[0])!==n)return console.log("warning! The block(0) has been changed."),!1}return!0}},{key:"setChain",value:function(e,t){this.difficulty=e,this.miningAward=t}}]),e}();e.exports.Blockchain=i}.call(this,a(37)(e))},78:function(e,t,a){},79:function(e,t,a){},80:function(e,t,a){},81:function(e,t,a){},82:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(39),r=a.n(c),i=(a(47),a(5)),s=a(11),o=a(1),m=(a(48),function(e){var t=e.block,a=e.index;return l.a.createElement("div",{className:"block-card card"},l.a.createElement("ul",{className:"list-group list-group-flush"},l.a.createElement("li",{className:"list-group-item"},l.a.createElement("h5",{className:"card-title"},"Block",a+1,"0"===t.prevHash?l.a.createElement("small",{className:"origin-title"},"(origin block)"):null)),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("h6",null,"Hash"),l.a.createElement("small",{style:{color:"#"+t.hash.substring(6,12)}},t.hash.substring(0,37)+"..."),l.a.createElement("h6",{className:"mt-2"},"Hash of previous block"),l.a.createElement("small",{style:{color:"#"+t.prevHash.substring(6,12)},className:"pb-2"},"0"===t.prevHash?"0":t.prevHash.substring(0,37)+"...")),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("h6",null,"Random"),l.a.createElement("small",{className:"text-muted"},t.random)),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("h6",null,"Timestamp"),l.a.createElement("small",{className:"text-muted"},t.timestamp))))}),u=function(e){var t=e.queue,a=e.isDisplay;return l.a.createElement("table",{className:"table table-striped"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{scope:"col"},"#"),l.a.createElement("th",{scope:"col"},"From"),l.a.createElement("th",{scope:"col"},"To"),l.a.createElement("th",{scope:"col"},"Amount"),l.a.createElement("th",{scope:"col"},"Timestamp"),l.a.createElement("th",{scope:"col"},"Valid?"))),l.a.createElement("tbody",null,t.map((function(e,t){return l.a.createElement("tr",{key:e.timestamp},l.a.createElement("th",{scope:"col"},t),l.a.createElement("td",{className:"from-to"},null===e.from?l.a.createElement("div",null,"System",l.a.createElement("br",null),l.a.createElement("small",{className:"text-secondary"},"(mining award)")):l.a.createElement("div",null,a?l.a.createElement("span",null,e.from.substring(0,14),e.from.length>14?"...":null):l.a.createElement(i.b,{to:"/wallet/".concat(e.from)},e.from.substring(0,14),e.from.length>14?"...":null),l.a.createElement("br",null),"04c1a5b2e99d16"===e.from.substring(0,14)?l.a.createElement("small",{className:"text-secondary"},"(\u8fd9\u662f\u4f60)"):null)),l.a.createElement("td",{className:"from-to"},a?l.a.createElement("span",null,e.to.substring(0,14),e.to.length>14?"...":null):l.a.createElement(i.b,{to:"/wallet/".concat(e.to)},e.to.substring(0,14),e.to.length>14?"...":null),l.a.createElement("br",null),"04c1a5b2e99d16"===e.to.substring(0,14)?l.a.createElement("small",{className:"text-secondary"},"(\u8fd9\u662f\u4f60)"):null),l.a.createElement("td",null,e.amount),l.a.createElement("td",null,e.timestamp,l.a.createElement("br",null),l.a.createElement("small",{className:"text-secondary"},function(e){var t=new Date(e),a=(t.getYear()+1900).toString(),n=(t.getMonth()+1).toString(),l=t.getDate().toString(),c=t.getHours().toString(),r=t.getMinutes().toString(),i=t.getSeconds().toString();return a+"-"+(n=n<10?"0"+n:n)+"-"+(l=l<10?"0"+l:l)+" "+(c=c<10?"0"+c:c)+":"+r+":"+(i=i<10?"0"+i:i)}(e.timestamp))),e.isValid()?l.a.createElement("td",null,"\u2713"):l.a.createElement("td",null,"\u2717"))}))))},h=(a(54),a(15).initChain),d=function(){var e=Object(n.useState)(h),t=Object(o.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(a.chain),i=Object(o.a)(r,2),s=i[0],d=i[1],f=Object(n.useState)(s[0].transaction),b=Object(o.a)(f,2),E=b[0],g=b[1],v=Object(n.useState)(0),p=Object(o.a)(v,2),y=p[0],N=p[1];return l.a.createElement("div",{className:"home container mt-2"},l.a.createElement("h1",null,"Blocks on chain"),l.a.createElement("p",{className:"text-dark"},"\u6bcf\u5f20\u5361\u7247\u4ee3\u8868\u4e86\u533a\u5757\u94fe\u4e0a\u7684\u4e00\u4e2a\u533a\u5757\uff0c\u70b9\u51fb\u5bf9\u5e94\u7684\u533a\u5757\u67e5\u770b\u5176\u5305\u542b\u7684\u76f8\u5e94\u4ea4\u6613\u4fe1\u606f\u3002"),l.a.createElement("div",{className:"container px-0 card-container"},s.map((function(e,t){return l.a.createElement("div",{onClick:function(){!function(e){N(e),g(s[e].transaction)}(t)},key:e.hash,className:t===y?"click-card clicked-card":"click-card"},l.a.createElement(m,{block:e,index:t}))}))),l.a.createElement("div",{className:"container mt-3 transactions"},l.a.createElement("h1",null,"Transactions inside block",y+1),E.length?l.a.createElement(u,{queue:E,isDisplay:!1}):l.a.createElement("p",null,"\u6b64\u533a\u5757\u4e0d\u542b\u4ea4\u6613\u4fe1\u606f")),l.a.createElement("div",{onClick:function(){c(h),d(a.chain)}}))},f=a(14),b=a(6),E=a(15).initChain,g=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(E),i=Object(o.a)(r,2),s=i[0],m=i[1],u=Object(n.useState)(s.difficulty),h=Object(o.a)(u,2),d=h[0],g=h[1],v=Object(n.useState)(s.miningAward),p=Object(o.a)(v,2),y=p[0],N=p[1],k=Object(n.useState)({difficulty:d,award:y}),O=Object(o.a)(k,2),j=O[0],w=O[1];Object(n.useEffect)((function(){m(E),g(s.difficulty),N(s.miningAward)}),[s.difficulty,s.miningAward]);var S=function(e){w(Object(b.a)({},j,Object(f.a)({},e.target.id,Number(e.target.value))))};return l.a.createElement("div",{className:"setting"},a?l.a.createElement("div",{className:"alert alert-success"},l.a.createElement("div",{className:"container"},"\u8bbe\u7f6e\u6210\u529f")):null,l.a.createElement("div",{className:" container mt-2"},l.a.createElement("h1",null,"Setting"),l.a.createElement("p",{className:"text-dark"},"\u8bbe\u7f6e"),l.a.createElement("form",{onSubmit:function(e){e.preventDefault(),s.setChain(j.difficulty,j.award),c(!0),setTimeout((function(){c(!1)}),2e3)}},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"difficulty"},"Difficulty"),l.a.createElement("div",{className:"input-group"},l.a.createElement("input",{id:"difficulty",value:j.difficulty,onChange:S,className:"form-control",type:"number"}),l.a.createElement("div",{className:"input-group-append"},l.a.createElement("button",{className:"btn btn-outline-secondary"},"\u786e\u5b9a"))),l.a.createElement("small",{className:"text-secondary"},"\u96be\u5ea6\u503c\u4ee3\u8868\u4e86\u5c01\u88c5\u4e00\u4e2a\u533a\u5757\u7684\u96be\u6613\u7a0b\u5ea6\uff08\u8ba1\u7b97\u533a\u5757\u54c8\u5e0c\u503c\u65f6\u524d\u51e0\u4f4d\u4e3a0\u7684\u4e2a\u6570\uff09\u3002"),l.a.createElement("br",null),l.a.createElement("label",{htmlFor:"award",className:"mt-3"},"Award"),l.a.createElement("div",{className:"input-group"},l.a.createElement("input",{id:"award",value:j.award,className:"form-control",onChange:S,type:"number"}),l.a.createElement("div",{className:"input-group-append"},l.a.createElement("button",{className:"btn btn-outline-secondary"},"\u786e\u5b9a"))),l.a.createElement("small",{className:"text-secondary"},"Award\u503c\u4ee3\u8868\u5c01\u88c5\u4e00\u4e2a\u533a\u5757\u7cfb\u7edf\u4f1a\u7ed9\u4e88\u7684\u5956\u52b1\u3002")))))},v=(a(78),a(15).addTransaction),p={from:"04c1a5b2e99d166855a46f98fc92045e988b3a2f5b3bfd8fe9ea67e8575f54ead8d83de22813df14d6eaf05c6859a52c7a71101f4875273682f091245f792e5176",to:"",amount:"",timestamp:Date.now()},y={isError:!1,errorText:"warning."},N=function(){var e=Object(s.f)(),t=Object(n.useState)(p),a=Object(o.a)(t,2),c=a[0],r=a[1],i=Object(n.useState)(y),m=Object(o.a)(i,2),u=m[0],h=m[1],d=Object(n.useState)(!1),E=Object(o.a)(d,2),g=E[0],N=E[1],k=Object(n.useState)(!1),O=Object(o.a)(k,2),j=O[0],w=O[1],S=function(e){h(y),"amount"===e.target.id?r(Object(b.a)({},c,{amount:Number(e.target.value)})):r(Object(b.a)({},c,Object(f.a)({},e.target.id,e.target.value)))};return l.a.createElement("div",{className:"create-transaction"},j?l.a.createElement("div",{className:"alert alert-success"},l.a.createElement("div",{className:"container"},"\u4ea4\u6613\u63d0\u4ea4\u6210\u529f\uff01")):null,u.isError?l.a.createElement("div",{className:"alert alert-danger"},l.a.createElement("div",{className:"container"},u.errorText)):null,l.a.createElement("div",{className:"container mt-2"},l.a.createElement("h1",null,"Create Transaction"),l.a.createElement("p",{className:"text-dark"},"\u7ed9\u67d0\u4eba\u8f6c\u70b9\u94b1"),l.a.createElement("br",null),l.a.createElement("form",{onSubmit:function(t){t.preventDefault(),N(!0),r(Object(b.a)({},c,{timeStamp:Date.now()})),c.to&&c.amount?c.amount<0?setTimeout((function(){N(!1),h(Object(b.a)({},u,{isError:!0,errorText:"\u4ea4\u6613\u6570\u91cf\u5fc5\u987b\u5927\u4e8e0\u5662\uff01"})),r(Object(b.a)({},c,{amount:""}))}),1e3):setTimeout((function(){v(c),w(!0),r(p),N(!1),setTimeout((function(){w(!1),e.push("/trans-queue")}),1e3)}),1e3):setTimeout((function(){N(!1),h(Object(b.a)({},u,{isError:!0,errorText:"\u8fd8\u6709\u4ea4\u6613\u4fe1\u606f\u6ca1\u6709\u586b\u5199\u5b8c\u6574\u5662\uff01"}))}),1e3)}},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:"from"},"From"),l.a.createElement("input",{className:"form-control",placeholder:"04c1a5b2e99d166855a46f98fc92045e988b3a2f5b3bfd8fe9ea67e8575f54ead8d83de22813df14d6eaf05c6859a52c7a71101f4875273682f091245f792e5176",disabled:!0}),l.a.createElement("small",{className:"text-secondary"},"\u8fd9\u662f\u4f60\u7684\u94b1\u5305\u5730\u5740\uff0c\u4f60\u4e0d\u53ef\u4ee5\u4fee\u6539\u5b83\uff0c\u56e0\u4e3a\u4f60\u53ea\u80fd\u82b1\u81ea\u5df1\u7684\u94b1\u3002"),l.a.createElement("br",null),l.a.createElement("label",{htmlFor:"to",className:"mt-3"},"To"),l.a.createElement("input",{id:"to",value:c.to,onChange:S,className:"form-control"}),l.a.createElement("small",{className:"text-secondary"},"\u8fd9\u662f\u4f60\u60f3\u8f6c\u94b1\u5bf9\u8c61\u7684\u5730\u5740\uff08\u7531\u516c\u94a5\u4ea7\u751f\uff09\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u968f\u673a\u586b\u5199\u4e00\u4e9b\u5b57\u7b26\u4e32\u3002"),l.a.createElement("br",null),l.a.createElement("label",{htmlFor:"amount",className:"mt-3"},"Amount"),l.a.createElement("input",{id:"amount",value:c.amount,type:"number",onChange:S,className:"form-control"}),l.a.createElement("small",{className:"text-secondary"},"\u586b\u5165\u4ea4\u6613\u6570\u91cf\u3002 ")),l.a.createElement("button",{className:"btn btn-primary mt-3"},g?l.a.createElement("span",{className:"spinner-grow spinner-grow-sm mr-2"}):null,l.a.createElement("strong",null,"Sign & create transaction")))))},k=(a(79),a(15).initChain),O=function(e){var t=e.match.params.key,a=Object(n.useState)(k),c=Object(o.a)(a,2),r=c[0],i=c[1],s=Object(n.useState)(r.getTrans(t)),m=Object(o.a)(s,2),h=m[0],d=m[1];return l.a.createElement("div",{className:"wallet-detail container mt-2",key:t},l.a.createElement("h1",null,"Wallet details"),l.a.createElement("h4",null,"Address: "),l.a.createElement("div",null,t),l.a.createElement("h4",{className:"mt-3"},"Balence: "),l.a.createElement("div",null,r.getBalence(t)),l.a.createElement("h1",{className:"mt-5"},"Transactions"),h.length?l.a.createElement(u,{queue:h,isDisplay:!0}):l.a.createElement("p",null,"\u6b64\u7528\u6237\u6682\u65e0\u76f8\u5173\u4ea4\u6613\u8bb0\u5f55"),l.a.createElement("div",{onClick:function(){i(k),d(r.getTrans(t))}}))},j=(a(80),function(){return l.a.createElement("nav",{className:"navbar navbar-dark bg-dark"},l.a.createElement(i.b,{to:"/home",className:"nav-brand h3"},l.a.createElement("span",{className:"brand-text"},"flying"),"Chain"),l.a.createElement("div",null,l.a.createElement(i.b,{to:"/trans-queue",className:"btn btn-outline-light mr-3"},"\u4ea4\u6613\u961f\u5217",l.a.createElement("span",{className:"badge badge-light ml-2"},"!")),l.a.createElement(i.b,{to:"/setting",className:"btn btn-outline-light mr-3"},"\u8bbe\u7f6e"),l.a.createElement(i.b,{to:"/create",className:"btn btn-outline-light"},"\u521b\u5efa\u4ea4\u6613")))}),w=(a(81),a(15).initChain),S={isSuccess:!1,successText:"\u6316\u77ff\u6210\u529f\uff01"},T={isMining:!1,miningText:"\u52aa\u529b\u6316\u77ff\u4e2d..."},x=function(){var e=Object(s.f)(),t=Object(n.useState)(w),a=Object(o.a)(t,2),c=a[0],r=a[1],i=Object(n.useState)(c.transactionQueue),m=Object(o.a)(i,2),h=m[0],d=m[1],f=Object(n.useState)(!1),E=Object(o.a)(f,2),g=E[0],v=E[1],p=Object(n.useState)(T),y=Object(o.a)(p,2),N=y[0],k=y[1],O=Object(n.useState)(S),j=Object(o.a)(O,2),x=j[0],C=j[1];return l.a.createElement("div",null,N.isMining?l.a.createElement("div",{className:"alert alert-primary queue-alert"},l.a.createElement("div",{className:"container"},N.miningText)):null,x.isSuccess?l.a.createElement("div",{className:"alert alert-success queue-alert"},l.a.createElement("div",{className:"container"},x.successText)):null,l.a.createElement("div",{className:"transaction-queue container mt-2"},l.a.createElement("h1",null,"Transaction Queue"),l.a.createElement("p",{className:"text-dark"},"\u8fd9\u4e2a\u961f\u5217\u5b58\u653e\u7684\u4ea4\u6613\u8bb0\u5f55\u5c06\u4f1a\u51fa\u73b0\u5728\u4e0b\u4e00\u4e2a\u533a\u5757\u4e2d\uff0c\u82e5\u8981\u5c01\u88c5\u6b64\u533a\u5757\uff0c\u9700\u8981\u5f00\u59cb\u6316\u77ff\u8fc7\u7a0b\u3002"),l.a.createElement("br",null),h.length?l.a.createElement("div",null,l.a.createElement("div",{className:"card queue-card"},l.a.createElement(u,{queue:h,isDisplay:!1})),l.a.createElement("button",{className:"btn btn-primary mt-4",onClick:function(){v(!0),k(Object(b.a)({},N,{isMining:!0})),c.mineTheTransactionQueue(h[0].from),v(!1),k(T),C(Object(b.a)({},x,{isSuccess:!0})),setTimeout((function(){e.push("/"),C(S)}),2e3)}},g?l.a.createElement("span",{className:"spinner-grow spinner-grow-sm mr-2"}):null,l.a.createElement("strong",null,"Start mining"))):l.a.createElement("div",{className:"alert alert-warning no-alert"},l.a.createElement("p",{className:"text-dark"},"\u73b0\u5728\u8fd8\u6ca1\u6709\u4ea4\u6613\u8bb0\u5f55\u5662\uff01"))),l.a.createElement("div",{onClick:function(){r(w),d(c.transactionQueue)}}))};var C=function(){return l.a.createElement(i.a,null,l.a.createElement("div",{className:"App"},l.a.createElement(j,null),l.a.createElement(s.c,null,l.a.createElement(s.a,{path:"/home",component:d}),l.a.createElement(s.a,{path:"/setting",component:g}),l.a.createElement(s.a,{path:"/create",component:N}),l.a.createElement(s.a,{path:"/wallet/:key",component:O}),l.a.createElement(s.a,{path:"/trans-queue",component:x}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[42,1,2]]]);
//# sourceMappingURL=main.041f62ea.chunk.js.map